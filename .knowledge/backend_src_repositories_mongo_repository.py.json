{"is_source_file": true, "format": "Python", "description": "This file implements a MongoDB repository class for managing skills and lessons, including CRUD operations, indexing, and pagination/filtering mechanisms, specific to the application's domain model.", "external_files": ["bson.ObjectId", "pymongo.ASCENDING", "pymongo.collection.Collection", "pymongo.errors.DuplicateKeyError", "motor.motor_asyncio.AsyncIOMotorDatabase", "src.db.models.LessonModel", "src.db.models.SkillModel"], "external_methods": ["self._skills.create_index", "self._skills.count_documents", "self._skills.find", "self._skills.find_one", "self._skills.insert_one", "self._skills.find_one_and_update", "self._skills.delete_one", "self._skills.delete_many", "self._lessons.create_index", "self._lessons.find", "self._lessons.find_one", "self._lessons.insert_one", "self._lessons.find_one_and_update", "self._lessons.delete_one"], "published": ["MongoCatalogRepository"], "classes": [{"name": "MongoCatalogRepository", "description": "A repository class providing asynchronous CRUD operations for skills and lessons stored in MongoDB, including index management and search capabilities."}], "methods": [{"name": "Optional[str] _str_id(v: Any)", "description": "Helper function converting ObjectId or other types to string IDs for consistency.", "scope": "", "scopeKind": ""}, {"name": "None ensure_indexes(self)", "description": "Creates indexes on skills and lessons collections to enforce uniqueness and optimize queries.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Tuple[List[Dict[str,Any]],int] list_skills( self, category: Optional[str] = None, difficulty: Optional[str] = None, page: int = 1, page_size: int = 20, search: Optional[str] = None, )", "description": "Retrieves a paginated list of skills, optionally filtered by category, difficulty, or search term.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] get_skill_by_slug(self, slug: str)", "description": "Fetches a skill document by its slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Dict[str,Any] create_skill(self, skill: SkillModel)", "description": "Inserts a new skill document into the database and returns the created record with ID.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] update_skill(self, slug: str, updates: Dict[str, Any])", "description": "Updates an existing skill identified by slug with provided data.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "bool delete_skill(self, slug: str)", "description": "Deletes a skill by slug, including cascade deletion of associated lessons.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "List[Dict[str,Any]] list_lessons_for_skill(self, skill_slug: str)", "description": "Lists all lessons associated with a specific skill slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] get_lesson_by_slug(self, lesson_slug: str)", "description": "Retrieves a lesson document by its slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Dict[str,Any] create_lesson(self, lesson: LessonModel)", "description": "Creates a new lesson record in the database.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] update_lesson(self, slug: str, updates: Dict[str, Any])", "description": "Updates an existing lesson identified by slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "bool delete_lesson(self, slug: str)", "description": "Deletes a lesson by its slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Dict[str,Any] _serialize_skill(self, doc: Dict[str, Any])", "description": "Serializes a skill document, converting ObjectId to string and adding 'id' field.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Dict[str,Any] _serialize_lesson(self, doc: Dict[str, Any])", "description": "Serializes a lesson document similarly, converting ObjectId to string and adding 'id' field.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "None __init__(self, db: AsyncIOMotorDatabase)", "scope": "MongoCatalogRepository", "scopeKind": "class", "description": "unavailable"}], "calls": ["self._skills.create_index", "self._skills.count_documents", "self._skills.find", "self._skills.find_one", "self._skills.insert_one", "self._skills.find_one_and_update", "self._skills.delete_one", "self._lessons.find", "self._lessons.find_one", "self._lessons.insert_one", "self._lessons.find_one_and_update", "self._lessons.delete_one", "self._lessons.delete_many"], "search-terms": ["MongoRepository", "skills management", "lessons CRUD", "index creation", "pagination filtering", "async MongoDB"], "state": 2, "file_id": 22, "knowledge_revision": 67, "git_revision": "d6098fa8e57823041338944baf99a4e23adf6358", "revision_history": [{"49": ""}, {"63": "d6098fa8e57823041338944baf99a4e23adf6358"}, {"67": "d6098fa8e57823041338944baf99a4e23adf6358"}], "ctags": [{"_type": "tag", "name": "MongoCatalogRepository", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^class MongoCatalogRepository:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    def __init__(self, db: AsyncIOMotorDatabase) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, db: AsyncIOMotorDatabase)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "_serialize_lesson", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    def _serialize_lesson(self, doc: Dict[str, Any]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, doc: Dict[str, Any])", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "_serialize_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    def _serialize_skill(self, doc: Dict[str, Any]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, doc: Dict[str, Any])", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "_str_id", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^def _str_id(v: Any) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "create_lesson", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def create_lesson(self, lesson: LessonModel) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, lesson: LessonModel)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "create_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def create_skill(self, skill: SkillModel) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, skill: SkillModel)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "delete_lesson", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def delete_lesson(self, slug: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "delete_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def delete_skill(self, slug: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "ensure_indexes", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def ensure_indexes(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "get_lesson_by_slug", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def get_lesson_by_slug(self, lesson_slug: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, lesson_slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "get_skill_by_slug", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def get_skill_by_slug(self, slug: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "list_lessons_for_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def list_lessons_for_skill(self, skill_slug: str) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "member", "signature": "(self, skill_slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "list_skills", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def list_skills($/", "language": "Python", "typeref": "typename:Tuple[List[Dict[str,Any]],int]", "kind": "member", "signature": "( self, category: Optional[str] = None, difficulty: Optional[str] = None, page: int = 1, page_size: int = 20, search: Optional[str] = None, )", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "update_lesson", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def update_lesson(self, slug: str, updates: Dict[str, Any]) -> Optional[Dict[str, Any]/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, slug: str, updates: Dict[str, Any])", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "update_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def update_skill(self, slug: str, updates: Dict[str, Any]) -> Optional[Dict[str, Any]]/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, slug: str, updates: Dict[str, Any])", "scope": "MongoCatalogRepository", "scopeKind": "class"}], "hash": "db92bc587856926be86483d08ab9d06e", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/repositories/mongo_repository.py"}