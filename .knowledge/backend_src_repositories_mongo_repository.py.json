{"is_source_file": true, "format": "Python", "description": "This file implements a MongoDB repository class for managing CRUD operations and indexing for skills and lessons in a learning platform. It includes methods for listing, creating, updating, deleting, and retrieving skills and lessons, with support for pagination and filtering.", "external_files": ["pymongo", "motor.motor_asyncio", "src.db.models"], "external_methods": ["pymongo.collection.Collection.create_index", "pymongo.collection.Collection.find", "pymongo.collection.Collection.count_documents", "pymongo.collection.Collection.find_one", "pymongo.collection.Collection.find_one_and_update", "pymongo.collection.Collection.delete_one", "pymongo.collection.Collection.delete_many", "pymongo.errors.DuplicateKeyError", "motor.motor_asyncio.AsyncIOMotorDatabase"], "published": ["MongoCatalogRepository"], "classes": [{"name": "MongoCatalogRepository", "description": "Provides asynchronous CRUD operations and indexing for skills and lessons stored in MongoDB, supporting pagination, filtering, and indexing."}], "methods": [{"name": "None ensure_indexes(self)", "description": "Creates necessary indexes on skills and lessons collections for efficient querying and uniqueness constraints.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Tuple[List[Dict[str,Any]],int] list_skills( self, category: Optional[str] = None, difficulty: Optional[str] = None, page: int = 1, page_size: int = 20, search: Optional[str] = None, )", "description": "Retrieves a list of skills based on optional filters like category, difficulty, and search term, with support for pagination.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] get_skill_by_slug(self, slug: str)", "description": "Fetches a skill document by its slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Dict[str,Any] create_skill(self, skill: SkillModel)", "description": "Inserts a new skill document into the database, raising an error if the slug already exists.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] update_skill(self, slug: str, updates: Dict[str, Any])", "description": "Updates fields of an existing skill identified by its slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "bool delete_skill(self, slug: str)", "description": "Deletes a skill by slug and optionally its related lessons.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "List[Dict[str,Any]] list_lessons_for_skill(self, skill_slug: str)", "description": "Lists all lessons associated with a specific skill slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] get_lesson_by_slug(self, lesson_slug: str)", "description": "Fetches a lesson document by its slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Dict[str,Any] create_lesson(self, lesson: LessonModel)", "description": "Inserts a new lesson document into the database, raising an error if the slug already exists.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Optional[Dict[str,Any]] update_lesson(self, slug: str, updates: Dict[str, Any])", "description": "Updates fields of an existing lesson identified by its slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "bool delete_lesson(self, slug: str)", "description": "Deletes a lesson by its slug.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Dict[str,Any] _serialize_skill(self, doc: Dict[str, Any])", "description": "Serializes a skill document, converting ObjectId to string.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "Dict[str,Any] _serialize_lesson(self, doc: Dict[str, Any])", "description": "Serializes a lesson document, converting ObjectId to string.", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"name": "None __init__(self, db: AsyncIOMotorDatabase)", "scope": "MongoCatalogRepository", "scopeKind": "class", "description": "unavailable"}], "calls": ["self._skills.create_index", "self._lessons.create_index", "self._skills.find", "self._skills.count_documents", "self._skills.find_one", "self._skills.find_one_and_update", "self._skills.delete_one", "self._skills.delete_many", "self._lessons.find", "self._lessons.find_one", "self._lessons.find_one_and_update", "self._lessons.delete_one", "self._skills.insert_one", "self._lessons.insert_one"], "search-terms": ["MongoDB CRUD", "skills and lessons repository", "async Python database access", "index creation", "lesson slug retrieval", "skill filtering"], "state": 2, "file_id": 22, "knowledge_revision": 63, "git_revision": "d6098fa8e57823041338944baf99a4e23adf6358", "revision_history": [{"49": ""}, {"63": "d6098fa8e57823041338944baf99a4e23adf6358"}], "ctags": [{"_type": "tag", "name": "MongoCatalogRepository", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^class MongoCatalogRepository:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    def __init__(self, db: AsyncIOMotorDatabase) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, db: AsyncIOMotorDatabase)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "_serialize_lesson", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    def _serialize_lesson(self, doc: Dict[str, Any]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, doc: Dict[str, Any])", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "_serialize_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    def _serialize_skill(self, doc: Dict[str, Any]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, doc: Dict[str, Any])", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "create_lesson", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def create_lesson(self, lesson: LessonModel) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, lesson: LessonModel)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "create_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def create_skill(self, skill: SkillModel) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, skill: SkillModel)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "delete_lesson", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def delete_lesson(self, slug: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "delete_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def delete_skill(self, slug: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "ensure_indexes", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def ensure_indexes(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "get_lesson_by_slug", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def get_lesson_by_slug(self, lesson_slug: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, lesson_slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "get_skill_by_slug", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def get_skill_by_slug(self, slug: str) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "list_lessons_for_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def list_lessons_for_skill(self, skill_slug: str) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "member", "signature": "(self, skill_slug: str)", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "list_skills", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def list_skills($/", "language": "Python", "typeref": "typename:Tuple[List[Dict[str,Any]],int]", "kind": "member", "signature": "( self, category: Optional[str] = None, difficulty: Optional[str] = None, page: int = 1, page_size: int = 20, search: Optional[str] = None, )", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "update_lesson", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def update_lesson(self, slug: str, updates: Dict[str, Any]) -> Optional[Dict[str, Any]/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, slug: str, updates: Dict[str, Any])", "scope": "MongoCatalogRepository", "scopeKind": "class"}, {"_type": "tag", "name": "update_skill", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/repositories/mongo_repository.py", "pattern": "/^    async def update_skill(self, slug: str, updates: Dict[str, Any]) -> Optional[Dict[str, Any]]/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "member", "signature": "(self, slug: str, updates: Dict[str, Any])", "scope": "MongoCatalogRepository", "scopeKind": "class"}], "hash": "e60e2913dd86a246cf7a236525b9a493", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/repositories/mongo_repository.py"}