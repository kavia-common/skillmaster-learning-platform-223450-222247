{"is_source_file": true, "format": "Python", "description": "This file provides minimal JWT authentication helpers for a FastAPI backend, including environment-based secret retrieval and an admin role authorization dependency.", "external_files": ["jwt", "fastapi", "fastapi.security"], "external_methods": ["jwt.decode", "os.getenv", "Depends", "HTTPException"], "published": ["get_jwt_secret", "require_admin"], "classes": [], "methods": [{"name": "Optional[str] get_jwt_secret()", "description": "Returns the JWT secret from environment variables or None if not set.", "scope": "", "scopeKind": ""}, {"name": "None require_admin( creds: Optional[HTTPAuthorizationCredentials] = Depends(bearer_scheme), )", "description": "A dependency that verifies JWT token presence and 'admin' role; raises HTTP exceptions if checks fail.", "scope": "", "scopeKind": ""}], "calls": ["os.getenv", "jwt.decode", "raise HTTPException"], "search-terms": ["JWT authentication", "FastAPI admin dependency", "JWT secret environment", "JWT role check"], "state": 2, "file_id": 23, "knowledge_revision": 51, "git_revision": "", "ctags": [{"_type": "tag", "name": "bearer_scheme", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/api/auth.py", "pattern": "/^bearer_scheme = HTTPBearer(auto_error=False)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "get_jwt_secret", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/api/auth.py", "pattern": "/^def get_jwt_secret() -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "require_admin", "path": "/home/kavia/workspace/code-generation/skillmaster-learning-platform-223450-222247/backend/src/api/auth.py", "pattern": "/^def require_admin($/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "( creds: Optional[HTTPAuthorizationCredentials] = Depends(bearer_scheme), )"}], "hash": "74f517a05020697f84524a5620591f83", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/auth.py", "fields": [{"name": "bearer_scheme = HTTPBearer(auto_error=False)", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"51": ""}]}